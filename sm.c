#include <fcntl.h>
#include <unistd.h>

#define PAYLOAD_FUNCTION_OFFSET 0x0000000000001259

static __attribute__((always_inline)) inline void n(void) {
	asm volatile("nop");
}

void exec_payload(void);

const char payload[] = {
	'\x90'
};

int main(const int c, char ** v, char ** e)
{
	(void) c;
	int exe_fd;
	
	exec_payload();
	
	if (!(exe_fd = open("/proc/self/exe", O_WRONLY)))
		return 1;
	if (lseek(exe_fd, PAYLOAD_FUNCTION_OFFSET, SEEK_SET) == -1) 
		goto exe_error;
	
	if (write(exe_fd, payload, sizeof(payload)) == -1)
		goto exe_error;
	
	close(exe_fd);
	
	execve("/proc/self/exe", v, e);
	return 0;
	
	exe_error:
	close(exe_fd);
	return 1;
}

// thats right!!!, 256 volatile nop instructions >:3
__attribute__((noinline)) void exec_payload(void) {
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
	n(); n(); n(); n(); n(); n(); n(); n();
}
